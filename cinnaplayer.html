<link rel="icon" type="image/png" href="oi.png">
<div id="mediaPlayer" class="window" style="width:720px;">
  <div class="title-bar">CinnaOS Media Player</div>
  <div class="content">
    <!-- Video/Audio Player -->
    <video id="player" width="720" height="405" controls style="display:none;">
      Your browser does not support video playback.
    </video>

    <!-- YouTube Embed -->
    <div id="youtubeContainer" style="width:720px; height:405px; display:none;">
      <iframe id="youtubeFrame" width="720" height="405" frameborder="0" allowfullscreen></iframe>
    </div>
    <br>

    <!-- File Input -->
    <input type="file" id="fileInput" accept="audio/*,video/*">
    <button id="saveBtn" disabled>Save Video Link</button>
    <br><br>

    <!-- URL Input -->
    <input type="text" id="urlInput" placeholder="Enter YouTube URL" style="width:60%;">
    <button id="loadURL">Load Video</button>
  </div>
</div>

<script>
const fileInput = document.getElementById("fileInput");
const player = document.getElementById("player");
const saveBtn = document.getElementById("saveBtn");
const urlInput = document.getElementById("urlInput");
const loadURL = document.getElementById("loadURL");
const youtubeContainer = document.getElementById("youtubeContainer");
const youtubeFrame = document.getElementById("youtubeFrame");

let currentLink = null;

// --- Load local files ---
fileInput.addEventListener("change", (event) => {
  const file = event.target.files[0];
  if (file) {
    const url = URL.createObjectURL(file);
    player.src = url;
    player.style.display = "block";
    youtubeContainer.style.display = "none";
    player.play();
    currentLink = null;       // No save for local files
    saveBtn.disabled = true;  // Disable save button
  }
});

// --- Load YouTube links ---
loadURL.addEventListener("click", () => {
  const url = urlInput.value.trim();
  if (!url) return alert("Enter a YouTube URL!");
  
  const match = url.match(/(?:v=|\/)([a-zA-Z0-9_-]{11})/);
  if (!match) return alert("Invalid YouTube URL!");
  
  const videoID = match[1];
  youtubeFrame.src = `https://www.youtube.com/embed/${videoID}`;
  youtubeContainer.style.display = "block";
  player.style.display = "none";
  currentLink = `https://www.youtube.com/watch?v=${videoID}`;
  saveBtn.disabled = false; // Enable save button for links
});

// --- Save video link ---
saveBtn.addEventListener("click", () => {
  if (!currentLink) return alert("No video link to save!");
  const a = document.createElement("a");
  a.href = URL.createObjectURL(new Blob([currentLink], {type: "text/plain"}));
  a.download = "CinnaOS_video_link.txt";
  a.click();
});
</script>
